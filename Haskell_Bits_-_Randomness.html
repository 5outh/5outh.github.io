<!DOCTYPE html></!DOCTYPE html><html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>Haskell Bits 1 - Randomness - Ben Kovach</title><link href="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" rel="icon" /><link href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.7/dist/semantic.min.css" rel="stylesheet" /><style type="text/css">body{background-color:#eeeeee !important;font-family:"Ubuntu", serif !important}body .ui.container{font-family:"Ubuntu", serif !important}body h1, h2, h3, h4, h5, h6, .ui.header, .headerFont{font-family:"Kanit", sans-serif !important}body code, pre, tt, .monoFont{font-family:"Roboto Mono","SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace !important}body div.z-index p.info{color:#808080}body div.z-index ul{list-style-type:square;padding-left:1.5em}body div.z-index .uplinks{margin-left:0.29999em}body div#neuron-theme-default-teal .zettel-content h1{background-color:rgba(0,181,173,0.1)}body div#neuron-theme-default-teal span.zettel-link-container span.zettel-link a{color:#00b5ad}body div#neuron-theme-default-teal span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#00b5ad}body div#neuron-theme-default-teal .deemphasized:hover div.item a:hover{color:#00b5ad !important}body div#neuron-theme-default-teal div#footnotes{border-top-color:#00b5ad}body div#neuron-theme-default-brown .zettel-content h1{background-color:rgba(165,103,63,0.1)}body div#neuron-theme-default-brown span.zettel-link-container span.zettel-link a{color:#a5673f}body div#neuron-theme-default-brown span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#a5673f}body div#neuron-theme-default-brown .deemphasized:hover div.item a:hover{color:#a5673f !important}body div#neuron-theme-default-brown div#footnotes{border-top-color:#a5673f}body div#neuron-theme-default-red .zettel-content h1{background-color:rgba(219,40,40,0.1)}body div#neuron-theme-default-red span.zettel-link-container span.zettel-link a{color:#db2828}body div#neuron-theme-default-red span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#db2828}body div#neuron-theme-default-red .deemphasized:hover div.item a:hover{color:#db2828 !important}body div#neuron-theme-default-red div#footnotes{border-top-color:#db2828}body div#neuron-theme-default-orange .zettel-content h1{background-color:rgba(242,113,28,0.1)}body div#neuron-theme-default-orange span.zettel-link-container span.zettel-link a{color:#f2711c}body div#neuron-theme-default-orange span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#f2711c}body div#neuron-theme-default-orange .deemphasized:hover div.item a:hover{color:#f2711c !important}body div#neuron-theme-default-orange div#footnotes{border-top-color:#f2711c}body div#neuron-theme-default-yellow .zettel-content h1{background-color:rgba(251,189,8,0.1)}body div#neuron-theme-default-yellow span.zettel-link-container span.zettel-link a{color:#fbbd08}body div#neuron-theme-default-yellow span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#fbbd08}body div#neuron-theme-default-yellow .deemphasized:hover div.item a:hover{color:#fbbd08 !important}body div#neuron-theme-default-yellow div#footnotes{border-top-color:#fbbd08}body div#neuron-theme-default-olive .zettel-content h1{background-color:rgba(181,204,24,0.1)}body div#neuron-theme-default-olive span.zettel-link-container span.zettel-link a{color:#b5cc18}body div#neuron-theme-default-olive span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#b5cc18}body div#neuron-theme-default-olive .deemphasized:hover div.item a:hover{color:#b5cc18 !important}body div#neuron-theme-default-olive div#footnotes{border-top-color:#b5cc18}body div#neuron-theme-default-green .zettel-content h1{background-color:rgba(33,186,69,0.1)}body div#neuron-theme-default-green span.zettel-link-container span.zettel-link a{color:#21ba45}body div#neuron-theme-default-green span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#21ba45}body div#neuron-theme-default-green .deemphasized:hover div.item a:hover{color:#21ba45 !important}body div#neuron-theme-default-green div#footnotes{border-top-color:#21ba45}body div#neuron-theme-default-blue .zettel-content h1{background-color:rgba(33,133,208,0.1)}body div#neuron-theme-default-blue span.zettel-link-container span.zettel-link a{color:#2185d0}body div#neuron-theme-default-blue span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#2185d0}body div#neuron-theme-default-blue .deemphasized:hover div.item a:hover{color:#2185d0 !important}body div#neuron-theme-default-blue div#footnotes{border-top-color:#2185d0}body div#neuron-theme-default-violet .zettel-content h1{background-color:rgba(100,53,201,0.1)}body div#neuron-theme-default-violet span.zettel-link-container span.zettel-link a{color:#6435c9}body div#neuron-theme-default-violet span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#6435c9}body div#neuron-theme-default-violet .deemphasized:hover div.item a:hover{color:#6435c9 !important}body div#neuron-theme-default-violet div#footnotes{border-top-color:#6435c9}body div#neuron-theme-default-purple .zettel-content h1{background-color:rgba(163,51,200,0.1)}body div#neuron-theme-default-purple span.zettel-link-container span.zettel-link a{color:#a333c8}body div#neuron-theme-default-purple span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#a333c8}body div#neuron-theme-default-purple .deemphasized:hover div.item a:hover{color:#a333c8 !important}body div#neuron-theme-default-purple div#footnotes{border-top-color:#a333c8}body div#neuron-theme-default-pink .zettel-content h1{background-color:rgba(224,57,151,0.1)}body div#neuron-theme-default-pink span.zettel-link-container span.zettel-link a{color:#e03997}body div#neuron-theme-default-pink span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#e03997}body div#neuron-theme-default-pink .deemphasized:hover div.item a:hover{color:#e03997 !important}body div#neuron-theme-default-pink div#footnotes{border-top-color:#e03997}body div#neuron-theme-default-grey .zettel-content h1{background-color:rgba(118,118,118,0.1)}body div#neuron-theme-default-grey span.zettel-link-container span.zettel-link a{color:#767676}body div#neuron-theme-default-grey span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#767676}body div#neuron-theme-default-grey .deemphasized:hover div.item a:hover{color:#767676 !important}body div#neuron-theme-default-grey div#footnotes{border-top-color:#767676}body div#neuron-theme-default-black .zettel-content h1{background-color:rgba(27,28,29,0.1)}body div#neuron-theme-default-black span.zettel-link-container span.zettel-link a{color:#1b1c1d}body div#neuron-theme-default-black span.zettel-link-container span.zettel-link a:hover{color:#ffffff;background-color:#1b1c1d}body div#neuron-theme-default-black .deemphasized:hover div.item a:hover{color:#1b1c1d !important}body div#neuron-theme-default-black div#footnotes{border-top-color:#1b1c1d}body p{line-height:150%}body img{max-width:100%}body .deemphasized{font-size:0.84999em}body .deemphasized:hover{opacity:1}body .deemphasized:not(:hover){opacity:0.69999}body .deemphasized:not(:hover) a{color:#808080 !important}body div.zettel-view ul{padding-left:1.5em;list-style-type:square}body div.zettel-view .pandoc .highlight{background-color:#ffff00}body div.zettel-view .pandoc .ui.disabled.fitted.checkbox{margin-right:0.29999em;vertical-align:middle}body div.zettel-view .zettel-content .metadata{margin-top:1em}body div.zettel-view .zettel-content .metadata div.date{text-align:center;color:#808080}body div.zettel-view .zettel-content h1{padding-top:0.2em;padding-bottom:0.2em;text-align:center}body div.zettel-view .zettel-content h2{border-bottom:solid 1px #4682b4;margin-bottom:0.5em}body div.zettel-view .zettel-content h3{margin:0px 0px 0.4em 0px}body div.zettel-view .zettel-content h4{opacity:0.8}body div.zettel-view .zettel-content div#footnotes{margin-top:4em;border-top-style:groove;border-top-width:2px;font-size:0.9em}body div.zettel-view .zettel-content aside.footnote-inline{width:30%;padding-left:15px;margin-left:15px;float:right;background-color:#d3d3d3}body div.zettel-view .zettel-content .overflows{overflow:auto}body div.zettel-view .zettel-content code{margin:auto auto auto auto;font-size:100%}body div.zettel-view .zettel-content p code, li code, ol code{padding:0.2em 0.2em 0.2em 0.2em;background-color:#f8f8f8}body div.zettel-view .zettel-content pre{padding:0.5em 0.5em 0.5em 0.5em;overflow:auto;max-width:100%}body div.zettel-view .zettel-content div.pandoc-code{margin-left:auto;margin-right:auto}body div.zettel-view .zettel-content div.pandoc-code pre{background-color:#f8f8f8}body div.zettel-view .zettel-content dl dt{font-weight:bold}body div.zettel-view .zettel-content blockquote{background-color:#f9f9f9;border-left:solid 10px #cccccc;margin:1.5em 0px 1.5em 0px;padding:0.5em 10px 0.5em 10px}body div.zettel-view .zettel-content.raw{background-color:#dddddd}body .tree.flipped{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}body .tree{overflow:auto}body .tree ul.root{padding-top:0px;margin-top:0px}body .tree ul{position:relative;padding:1em 0px 0px 0px;white-space:nowrap;margin:0px auto 0px auto;text-align:center}body .tree ul::after{content:"";display:table;clear:both}body .tree ul:last-child{padding-bottom:0.1em}body .tree li{display:inline-block;vertical-align:top;text-align:center;list-style-type:none;position:relative;padding:1em 0.5em 0em 0.5em}body .tree li::before{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{right:auto;left:50%;border-left:solid 2px #cccccc}body .tree li:only-child{padding-top:0em}body .tree li:only-child::after{display:none}body .tree li:only-child::before{display:none}body .tree li:first-child::before{border-style:none;border-width:0px}body .tree li:first-child::after{border-radius:5px 0px 0px 0px}body .tree li:last-child::after{border-style:none;border-width:0px}body .tree li:last-child::before{border-right:solid 2px #cccccc;border-radius:0px 5px 0px 0px}body .tree ul ul::before{content:"";position:absolute;top:0px;left:50%;border-left:solid 2px #cccccc;width:0px;height:1.19999em}body .tree li div.forest-link{border:solid 2px #cccccc;padding:0.2em 0.29999em 0.2em 0.29999em;text-decoration:none;display:inline-block;border-radius:5px 5px 5px 5px;color:#333333;position:relative;top:2px}body .tree.flipped li div.forest-link{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}body .ui.label.zettel-tag{color:#000000}body .ui.label.zettel-tag a{color:#000000}body nav.backlinks-container{background-color:#eeeeee !important}body ul.backlinks > li{padding-bottom:0.4em;list-style-type:disc}body ul.context-list > li{list-style-type:lower-roman}body span.zettel-link-container span.zettel-link a{font-weight:bold;text-decoration:none}body span.zettel-link-container span.extra{color:auto}body span.zettel-link-container.errors{border:solid 1px #ff0000}body [data-tooltip]:after{font-size:0.69999em}body div.tag-tree div.node{font-weight:bold}body div.tag-tree div.node a.inactive{color:#555555}body .footer-version img{-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);-ms-filter:grayscale(100%);-o-filter:grayscale(100%);filter:grayscale(100%)}body .footer-version img:hover{-webkit-filter:grayscale(0%);-moz-filter:grayscale(0%);-ms-filter:grayscale(0%);-o-filter:grayscale(0%);filter:grayscale(0%)}body .footer-version, .footer-version a, .footer-version a:visited{color:#808080}body .footer-version a{font-weight:bold}body .footer-version{margin-top:1em !important;font-size:0.69999em}body nav.top-menu{padding-top:1em;padding-bottom:1em;justify-content:center;text-align:center}body nav.top-menu > *{padding-left:0px;padding-right:0px}@media only screen and (max-width: 768px){body div#zettel-container{margin-left:0.4em !important;margin-right:0.4em !important}}</style><link href="https://fonts.googleapis.com/css?family=Kanit|Ubuntu|Roboto+Mono&amp;display=swap" rel="stylesheet" /><script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><meta content="Ben Kovach" name="author" /><meta content="Haskell Bits is a new series of bite-sized posts that I hope will
empower people to “get it done and move on”, providing useful
information and links to learn more if desired. I’ll be providing full
main files in each example (with imports!) to make porting this stuff
into your own project as fricti" name="description" /><link href="https://kovach.me/Haskell_Bits_-_Randomness.html" rel="canonical" /><meta content="Haskell Bits 1 - Randomness" property="og:title" /><meta content="Ben Kovach" property="og:site_name" /><meta content="article" property="og:type" /><script type="application/ld+json">[]</script><style type="text/css">pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style></head><body><div class="ui fluid container" id="neuron-theme-default-blue"><nav class="top-menu"><div class="ui inverted compact neuron icon menu blue"><a class="left item" href="." title="Home"><i class="home icon"></i></a><a class="left item" href="search.html" title="Search Zettels"><i class="search icon"></i></a><a class="center item" href="https://github.com/5outh/zettelkasten/edit/master/Haskell Bits - Randomness.md" title="Edit this Zettel"><i class="edit icon"></i></a><a class="right item" href="z-index.html" title="All Zettels (z-index)"><i class="tree icon"></i></a></div></nav><div class="ui text container" id="zettel-container" style="position: relative"><div id="zettel-container-anchor" style="position: absolute; top: -24px; left: 0"></div><div class="zettel-view"><article class="ui raised attached segment zettel-content"><h1>Haskell Bits 1 - Randomness</h1><div class="pandoc"><p>Haskell Bits is a new series of bite-sized posts that I hope will empower people to “get it done and move on”, providing useful information and links to learn more if desired. I’ll be providing full <code>main</code> files in each example (with imports!) to make porting this stuff into your own project as frictionless as possible. This first “Haskell Bit” will cover randomness.</p><p>You need at least two things to produce a random number:</p><ul><li>An initial “seed” value</li><li>A pure function that produces a new number from that seed. (“RNG”)</li></ul><p>That’s all for a single number.</p><p>Most programming languages will hide these details from you unless you need them. Most of the time, you can just call <code>random()</code> and get a random number (typically between 0 and 1), using a seed value generated from some system variable that is always changing (current time in very small units is common).</p><p>The simplest way to replicate this behavior in Haskell is by using the <code>System.Random</code> module, part of the <a href="https://hackage.haskell.org/package/random-1.1/docs/System-Random.html"><code>random</code></a> package.</p><p>We can use <code>randomIO</code> and <code>randomRIO</code> to pull from a global RNG:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  </span><span class="co">-- A random `Double` between 0 and 1</span>
<span class="">  (</span><span class="ot">randomIO ::</span><span class=""> </span><span class="dt">IO</span><span class=""> </span><span class="dt">Double</span><span class="">) </span><span class="op">&gt;&gt;=</span><span class=""> </span><span class="fu">print</span>

<span class="">  </span><span class="co">-- A random `Int` between 1 and 6 (A die roll)</span>
<span class="">  randomRIO (</span><span class="dv">1</span><span class="">, </span><span class="dv">6</span><span class="">) </span><span class="op">&gt;&gt;=</span><span class=""> </span><span class="fu">print</span>
</code></pre></div><p>This is pretty much the interface that most other languages start with. Better would be to separate out IO as much as possible from the inevitable rest of our program. We can do that by confining IO usage to one operation: coming up with an initial RNG.</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>

<span class="ot">dieRoll ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> g </span><span class="ot">-&gt;</span><span class=""> (</span><span class="dt">Int</span><span class="">, g)</span>
<span class="">dieRoll </span><span class="ot">=</span><span class=""> randomR (</span><span class="dv">1</span><span class="">, </span><span class="dv">6</span><span class="">)</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  </span><span class="co">-- New generator, generated from the system RNG </span>
<span class="">  gen </span><span class="ot">&lt;-</span><span class=""> newStdGen </span>

<span class="">  </span><span class="kw">let</span><span class=""> (result, newGen) </span><span class="ot">=</span><span class=""> dieRoll gen</span>
<span class="">  </span><span class="fu">print</span><span class=""> result</span>

<span class="">  </span><span class="kw">let</span><span class=""> (newResult, newNewGen) </span><span class="ot">=</span><span class=""> dieRoll newGen</span>
<span class="">  </span><span class="fu">print</span><span class=""> newResult </span>
</code></pre></div><p>We don’t want to duplicate this code every time we want to add a new die roll. The next logical step would be to sprinkle in some <code>State</code> to store the current RNG in:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad.State</span>

<span class="ot">dieRoll ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">State</span><span class=""> g </span><span class="dt">Int</span>
<span class="">dieRoll </span><span class="ot">=</span><span class=""> state (randomR (</span><span class="dv">1</span><span class="">, </span><span class="dv">6</span><span class="">))</span>

<span class="ot">twoDice ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">State</span><span class=""> g </span><span class="dt">Int</span>
<span class="">twoDice </span><span class="ot">=</span><span class=""> (</span><span class="op">+</span><span class="">) </span><span class="op">&lt;$&gt;</span><span class=""> dieRoll </span><span class="op">&lt;*&gt;</span><span class=""> dieRoll</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  gen </span><span class="ot">&lt;-</span><span class=""> newStdGen</span>
<span class="">  </span><span class="fu">print</span><span class=""> (evalState twoDice gen)</span>
</code></pre></div><p>Now we can run more complex programs that employ random numbers. Note that <code>newStdGen</code> can be replaced with <code>mkStdGen :: Int -&gt; StdGen</code> if you want to provide an integral seed instead of using the global <code>StdGen</code>.</p><p>You can avoid some of the state boilerplate and get a few more benefits by bringing in the <a href="https://hackage.haskell.org/package/MonadRandom-0.5"><code>MonadRandom</code></a> package. Here’s some code that accomplishes the same goal using <code>MonadRandom</code>:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad.Random</span>

<span class="ot">dieRoll ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g </span><span class="dt">Int</span>
<span class="">dieRoll </span><span class="ot">=</span><span class=""> getRandomR (</span><span class="dv">1</span><span class="">, </span><span class="dv">6</span><span class="">)</span>

<span class="ot">twoDice ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g </span><span class="dt">Int</span>
<span class="">twoDice </span><span class="ot">=</span><span class=""> (</span><span class="op">+</span><span class="">) </span><span class="op">&lt;$&gt;</span><span class=""> dieRoll </span><span class="op">&lt;*&gt;</span><span class=""> dieRoll</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  gen </span><span class="ot">&lt;-</span><span class=""> newStdGen</span>
<span class="">  </span><span class="fu">print</span><span class=""> (evalRand twoDice gen)</span>
</code></pre></div><p>Apart from providing a nice way to write (slightly) terser randomness code, <code>MonadRandom</code> is more explicit about the domain we’re working in, and ships with a couple of killer utilities; namely, the minimalistic sampling functions <code>uniform</code> and <code>fromList</code> (also <code>weighted</code> from <code>MonadRandom 0.5</code>). This program, for example, generates a list of 20 moves that might come up in a Dance Dance Revolution song:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>

<span class="kw">data</span><span class=""> </span><span class="dt">Direction</span><span class=""> </span><span class="ot">=</span><span class=""> </span><span class="dt">U</span><span class=""> </span><span class="op">|</span><span class=""> </span><span class="dt">D</span><span class=""> </span><span class="op">|</span><span class=""> </span><span class="dt">L</span><span class=""> </span><span class="op">|</span><span class=""> </span><span class="dt">R</span><span class=""> </span><span class="kw">deriving</span><span class=""> (</span><span class="dt">Show</span><span class="">, </span><span class="dt">Eq</span><span class="">)</span>

<span class="ot">step ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g </span><span class="dt">Direction</span>
<span class="">step </span><span class="ot">=</span><span class=""> uniform [</span><span class="dt">U</span><span class="">,</span><span class="dt">D</span><span class="">,</span><span class="dt">L</span><span class="">,</span><span class="dt">R</span><span class="">]</span>

<span class="ot">stepWeighted ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g </span><span class="dt">Direction</span>
<span class="">stepWeighted </span><span class="ot">=</span>
<span class="">    fromList [(</span><span class="dt">U</span><span class="">, </span><span class="dv">1</span><span class="">), (</span><span class="dt">D</span><span class="">, </span><span class="dv">1</span><span class="">), (</span><span class="dt">L</span><span class="">, </span><span class="dv">50</span><span class="">), (</span><span class="dt">R</span><span class="">, </span><span class="dv">100</span><span class="">)]</span>

<span class="ot">danceDanceRevolutionScroll ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g [</span><span class="dt">Direction</span><span class="">]</span>
<span class="">danceDanceRevolutionScroll </span><span class="ot">=</span><span class=""> replicateM </span><span class="dv">20</span><span class=""> </span><span class="op">$</span><span class=""> </span><span class="kw">do</span>
<span class="">    weightIt </span><span class="ot">&lt;-</span><span class=""> uniform [</span><span class="dt">True</span><span class="">, </span><span class="dt">False</span><span class="">]</span>
<span class="">    </span><span class="kw">if</span><span class=""> weightIt </span><span class="kw">then</span><span class=""> stepWeighted </span><span class="kw">else</span><span class=""> step</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  gen </span><span class="ot">&lt;-</span><span class=""> newStdGen</span>
<span class="">  </span><span class="fu">print</span><span class=""> (evalRand danceDanceRevolutionScroll gen)</span>
</code></pre></div><p><code>fromList</code> lets you specify weights for your random elements. <code>L</code> and <code>R</code> will probably show up a lot more than the other two directions when this is run.</p><p><code>MonadRandom</code> supplies some other conveniences as well, but it’s not crazy stuffed with functionality. It’s a nice package that contains the minimal amount of code to be useful but not overengineered.</p><p>That said, sometimes you need more. First off, what about different distributions? The normal distribution is a pretty common necessity. <a href="https://hackage.haskell.org/package/random-fu"><code>random-fu</code></a> really shines in this domain. You’ll have to pull in the <a href="https://hackage.haskell.org/package/rvar"><code>rvar</code></a> package as well to run this next example, which will print out a random number pulled from a normal distribution with mean <code>100</code> and a standard deviation of <code>5</code>:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad</span>
<span class="kw">import</span><span class=""> </span><span class="dt">System.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Data.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Data.RVar</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad.State</span>

<span class="ot">normalNumber ::</span><span class=""> </span><span class="dt">State</span><span class=""> </span><span class="dt">StdGen</span><span class=""> </span><span class="dt">Double</span>
<span class="">normalNumber </span><span class="ot">=</span><span class=""> sampleRVar (normal </span><span class="dv">100</span><span class=""> </span><span class="dv">5</span><span class="">)</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> </span><span class="kw">do</span>
<span class="">  gen </span><span class="ot">&lt;-</span><span class=""> newStdGen</span>
<span class="">  </span><span class="fu">print</span><span class=""> (evalState normalNumber gen)</span>
</code></pre></div><p>Notice the <code>State</code> pattern from earlier. Also, there a bunch of common distributions that ship with <code>random-fu</code>.</p><p>One last thing I should mention is that we’re not tied to <code>StdGen</code>, the RNG that ships with <code>random</code>.</p><p>In fact, it does not have strong statistical properties, and should probably be avoided for many “real” applications (See <a href="https://www.reddit.com/r/haskell/comments/3x15sm/why_is_the_first_random_value_produced_from_a/">this reddit post</a>, and thank you to reddit user tom-md for the note!).</p><p>There are faster and more stable ones ones, like <code>PureMT</code> from <a href="https://hackage.haskell.org/package/random-source"><code>random-source</code></a> or <code>TFGen</code> from <a href="https://hackage.haskell.org/package/tf-random"><code>tf-random</code></a>. These are both instances of <code>RandomGen</code>, so you can plug either one of those in wherever you saw the generic type signature <code>RandomGen g =&gt; ...</code> in this post. For example, mixing <code>PureMT</code> back into <code>MonadRandom</code>:</p><div class="pandoc-code highlighted"><pre><code class="haskell"><span class="kw">import</span><span class=""> </span><span class="dt">Control.Monad.Random</span>
<span class="kw">import</span><span class=""> </span><span class="dt">Data.Random.Source.PureMT</span>

<span class="ot">dieRoll ::</span><span class=""> </span><span class="dt">RandomGen</span><span class=""> g </span><span class="ot">=&gt;</span><span class=""> </span><span class="dt">Rand</span><span class=""> g </span><span class="dt">Int</span>
<span class="">dieRoll </span><span class="ot">=</span><span class=""> getRandomR (</span><span class="dv">1</span><span class="">, </span><span class="dv">6</span><span class="">)</span>

<span class="ot">main ::</span><span class=""> </span><span class="dt">IO</span><span class=""> ()</span>
<span class="">main </span><span class="ot">=</span><span class=""> newPureMT </span><span class="op">&gt;&gt;=</span><span class=""> </span><span class="fu">print</span><span class=""> </span><span class="op">.</span><span class=""> evalRand dieRoll </span>
</code></pre></div><p>Ben</p></div><div class="metadata"><div class="date" title="Zettel date"><time datetime="2017-01-30">2017-01-30</time></div></div></article><nav class="ui bottom attached segment deemphasized backlinks-container"><h3 class="ui header">Backlinks</h3><ul class="backlinks"><li><span class="zettel-link-container cf"><span class="zettel-link" data-inverted="" data-position="right center" data-tooltip="Tags: home"><a href=".">Ben Kovach</a></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc">Linking by tag: <code>Essays</code></div></li></ul></li></ul><a class="ui right ribbon label zettel-tag " href="search.html?tag=Haskell" title="See all zettels tagged &#39;Haskell&#39;">Haskell</a><p></p><a class="ui right ribbon label zettel-tag " href="search.html?tag=Essays" title="See all zettels tagged &#39;Essays&#39;">Essays</a><p></p></nav></div></div><div class="ui one column grid footer-version"><div class="center aligned column"><div class="ui tiny image"><a href="https://neuron.zettel.page"><img alt="logo" src="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" title="Generated by Neuron" /></a></div></div></div></div></body></html>